import pandas as pd
from pandasql import sqldf
from fpdf import FPDF

# 1. Leer archivo Excel y seleccionar columnas especÃ­ficas
# Reemplaza 'archivo.xlsx' por el nombre del archivo real.
usecols = ['Columna1', 'Columna2', 'Columna3']
df = pd.read_excel('archivo.xlsx', usecols=usecols)

# 2. Ejecutar consulta SQL sobre el DataFrame
pysqldf = lambda q: sqldf(q, locals())
query = """
SELECT Columna1, Columna2 
FROM df
WHERE Columna3 > 100
"""
resultado = pysqldf(query)

# 3. Generar PDF con los resultados
pdf = FPDF()
pdf.add_page()
pdf.set_font("Arial", size=12)

# Agrega una cabecera al PDF
if not resultado.empty:
    header = ' | '.join(resultado.columns)
    pdf.cell(200, 10, txt=header, ln=True)

# Agrega cada fila del resultado
for _, row in resultado.iterrows():
    linea = ' | '.join(str(val) for val in row)
    pdf.cell(200, 10, txt=linea, ln=True)

# Guardar el PDF
pdf.output("reporte.pdf")
print("PDF generado: reporte.pdf")
